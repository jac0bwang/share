# 移植Linux 到 ARM 概要

1. SoC

SoC 既是 System On Chip 片上系统

ARM 公司主要设计 CPU 核： 指令集，MMU， caches 等，他们不卖硬件的

Texas Instruments, Atmel, Marvell, Freescale, Qualcomm, Nvidia, Broadcom. 这些公司从ARM 公司买来 CPU 核进行设计，在其上添加
外设，或者在内部设计。他们卖的东西就是 SoC。

对于我们的交换机来说用的是 Broadcom 生产的 BCM56430

2. 硬件和软件的选择

在移植 Linux 内核的时候需要考虑 2 件事情，就是硬件和软件的东西

在选择硬件的时候会考虑下软件是不是支持，就是在移植Linux的时候会考虑内核的版本是否支持该款CPU等
- 在开源的项目中是否有相应的驱动，是否支持全部的功能
- 这些驱动是不是生产商提供支持的
- 如果没有相应的驱动就要考虑，这些硬件和设计框架有多复杂

从软件方面来看，Bootloaders 和 Linux内核 都可以从 SoC 生产商或者其开源社区的主线分支获得

3. 移植 Linux

在移植 Linux 的时候首先要选择一个内核版本，这里我们已经有了一个固定的版本 4.14.y， 就基于次版本做相应的移植工作

移植内核包括：
- 添加要支持的的 CPU 核
- 编写SoC外围设备驱动程序和SoC特性功能(SMP、电源管理)
- 编写板级外设驱动程序
- 整合所有驱动程序，并描述外设是如何连接到板上的 (DTS)

在这些步骤中前面 2 项是 SoC 厂商，在设计芯片的时候做好的，第三项是设计主板的硬件厂商在设计的时候选择了什么硬件固定的下来的。
在我们公司中做的最多的就是最后两项的工作
